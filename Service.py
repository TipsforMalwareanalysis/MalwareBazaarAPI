import BazzerHelper


def download(malwaresha256):
    bazzar = BazzerHelper.BazzarHelper()
    bazzar.downloadSample(malwaresha256)

def getMalwaresFromSignature(signature):
    """
    시그니처 기반 악성코드 검색
    :param signature: 악성코드 시그니처
    :return: 
    """
    bazzar = BazzerHelper.BazzarHelper()
    return bazzar.querySignature(signature).json()

def download_malwares(_list):

    for dict_item in _list:
        malware_sha256 = dict_item['sha256_hash']
        download(malware_sha256)

def unzipMalware(self, path):
    """
    악성코드 압축풀기
    :param path:
    :return:
    """
    pass
    with pyzipper.AESZipFile(path) as zf:
        zf.pwd = "infected"
        zf.extract(path)