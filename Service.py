import BazzerHelper
import pyzipper

def download(malwaresha256):
    bazzar = BazzerHelper.BazzarHelper()
    bazzar.downloadSample(malwaresha256)

def getMalwaresFromSignature(signature):
    """
    시그니처 기반 악성코드 검색
    :param signature: 악성코드 시그니처
    :return: 
    """
    bazzar = BazzerHelper.BazzarHelper()
    return bazzar.querySignature(signature).json()

def download_malwares(_list):
    print("[*] 다운로드 시작")

    for idx, dict_item in enumerate(_list):
        print("[*][*] {}파일 다운로드".format(idx+1))

        malware_sha256 = dict_item['sha256_hash']
        download(malware_sha256)

        break

    print("[*] 다운로드 종료")
    print()

def unzipMalware(self, path):
    """
    악성코드 압축풀기
    :param path:
    :return:
    """
    pass
    with pyzipper.AESZipFile(path) as zf:
        zf.pwd = "infected"
        zf.extract(path)